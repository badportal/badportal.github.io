<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signal X Webflasher</title>
    <meta name="description" content="Easily allow users to flash Signal X Firmware to their ESP-devices on the web." />
    <meta name="viewport" content="width=device-width" />
    <meta property="og:title" content="Signal X Firmware" />
    <meta property="og:site_name" content="Signal X Firmware" />
    <meta property="og:url" content="https://signalx.ddns.net/" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="" />
    <meta property="og:image" content="https://flippertools.ddns.net/cdn/signalx.gif" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Signal X Webflasher" />
    <meta name="twitter:description" content="Easily allow users to flash Signal X Firmware to their ESP-devices on the web." />
    <meta name="twitter:image" content="https://flippertools.ddns.net/cdn/signalx.gif" />
    <meta name="color-scheme" content="dark light" />
    <link rel="stylesheet" href="../style.css">
    <script type="module" src="https://unpkg.com/esp-web-tools@9.1.2/dist/web/install-button.js?module"></script>

<style>
    body {
        font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, Ubuntu, sans-serif;
        padding: 0;
        margin: 0;
        line-height: 1.4;
        background-color: #111827;
        color: #ADD8E6;
    }
    .content {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    h1 {
        margin-top: 2em;
    }
    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        border: 1px solid #1F2937;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .unsupported-message {
        color: red;
        font-size: 14px;
        display: none;
    }
    button {
      background-color: #ADD8E6;
      color: #1e1e1e;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      cursor: pointer;
      margin-top: 10px;
      border-radius: 5px;
    }
    button:hover {
      background-color: #0000FF;
    }
</style>
</head>
<body>
    <header class="page-header">
        <div class="header-content">
            <h1>Download <span>Firmware</span></h1>
            <p>Get started with Signal X Firmware</p>
        </div>
    </header>

    <section class="download-section">
        <div class="container">
            <div class="download-card">
                <div class="card-header">
                    <h3>Latest Release</h3>
                    <hr style="border: 1px solid #ADD8E6;">
                    <span class="version">DEV v0.5</span>
                </div>
                <div class="card-content">
                    <ul class="release-notes">
                        <li>Enhanced WiFi scanning capabilities</li>
                        <li>Improved IR database with 1000+ new devices</li>
                        <li>Performance optimizations</li>
                        <li>Bug fixes and stability improvements</li>
                    </ul>

                    <div class="device-selector">
                        <label for="device">Select Your Device:</label>
                        <select id="device" class="device-select">
                            <option value="none">-- Select Device --</option>
                            <option value="m5stickcp2">M5StickC Plus2 [WORKING]</option>
                            <option value="m5stickcp">M5StickC Plus [WORKING]</option>
                            <option value="m5stickheadless">M5StickC Plus2 Headless [COMING SOON]</option>
                            <option value="esp8266">ESP8266 [WORKING]</option>
                        </select>
                    </div>

                    <p id="unsupported-message" class="unsupported-message" style="text-align: center;">
                        Sorry, this browser does not support Web Serial. Try Google Chrome or Microsoft Edge. 
                        <br>
                        <span>(P.S - iOS devices don't work)</span>
                    </p>
                    <div style="text-align: center;">
                        <esp-web-install-button id="install-button">
                            <title>Flashing</title>
                        </esp-web-install-button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="../rights">Rights & Licenses</a>
                <a href="../credits">Credits</a>
            </div>
            <div class="copyright">
                Â© 2025 Signal X Firmware. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
    const manifestUrls = {
        "m5stickcp2": "./manifests/m5stickcp2.json",
        "m5stickcp": "./manifests/m5stickcp2.json",
        "m5stickheadless": "./manifests/m5stickcp2h.json",
        "esp8266": "./manifests/esp8266.json"
    };

    document.addEventListener("DOMContentLoaded", function () {
        const installButton = document.getElementById("install-button");
        const unsupportedMessage = document.getElementById("unsupported-message");
        const deviceSelect = document.getElementById("device");

        if ("serial" in navigator) {
            unsupportedMessage.style.display = "none"; 
        } else {
            installButton.style.display = "none"; 
            unsupportedMessage.style.display = "block"; 
        }

        deviceSelect.addEventListener("change", function () {
            const selectedDevice = this.value;
            if (selectedDevice && manifestUrls[selectedDevice]) {
                installButton.setAttribute("manifest", manifestUrls[selectedDevice]);
            } else {
                installButton.removeAttribute("manifest");
            }
        });
    });
    </script>
</body>
</html>
